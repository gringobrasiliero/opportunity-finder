<%= render 'form' %>
  <div class= "new_opportunity"></div>




<script type="text/javascript" charset="utf-8">

function Item(attributes){
  this.title = attributes.title;
  this.id = attributes.id;
  this.description = attributes.description;
}
Item.templateSource = $("#opp-template").html()
Item.template = Handlebars.compile(Item.templateSource);
Item.prototype.renderDiv = function() {
return Item.template(this)
}

  $(function () {
    $('form').on("submit", function(e) {
      //prevent form from submitting the default way
      e.preventDefault();
      var $form = $(this);
      var action = $form.attr("action");
      var params = $form.serialize();

      $.ajax({
        url: action,
        data: params,
        dataType: "json",
        method: "POST"
      })
      .success(function(json){
        var item = new Item(json);
        var itemDiv = item.renderDiv()

        console.log(json)

        $("div.new_opportunity").append(itemDiv)
      })
      .error(function(response){
        console.log("Broken", response)
      })
       })

    })


</script>


<script id="opp-template" type="text/x-handlebars-template">
  <div id="body-{{id}}">
  <h2> {{title}} </h2>
  <h2> {{description}} </h2>

</div>
</script>
